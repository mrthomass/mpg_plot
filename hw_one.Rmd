---
title: "Homework One"
author: "Thomas Scartz"
output: officedown::rdocx_document
---

```{r setup, include = FALSE}
library(tidyverse)
library(purrr)
```

**(1)** Write a function that will find the sum of the natural log, the common log and a log of base 2 for any given positive number. Use your function to find answers for the first five even integers. Show all details and structure of your function. You should get five answers. The first two answers are 1.994177 and 3.988354. (Your output should show the other three)

```{r question_1}
logg <- function(numb) {
  log(numb) + log10(numb) + log2(numb)
}

tibble(x = c(2, 4, 6, 8, 10), y = logg(x))
```

**(2)** Use the if-else structure to print the statement "This is a big number" if the square of a value is greater than or equal to 100 and the following statement is printed if the square of the number is less than 100, "This is not a big number". Use and show values of assignment and if-else structures that will output both statements.

```{r question_2}
num_judge <- function(numb) {
  if (numb^2 >= 100) {
    paste(as.character(numb), ": This is a big number")
  } else if (numb^2 < 100) {
    paste(as.character(numb), ": This is not a big number")
  }
}

num_judge(2)
num_judge(9)
num_judge(10)
num_judge(1000)
```

**(3)** For the following if-else-if coding structure, make an adjustment so that it prints "Team A won"

```{r question_3}
team_A <- 3 #if team A scored one more goal (total 3) they would win the game
team_B <- 2

if (team_A > team_B) {
  print("Team A won")
} else if (team_A < team_B) {
  print("Team B won")
} else {
  "Team A & B tied"
}
```

**(4)** Write an if- else if- else sequence of commands that will output the following statements and appropriate output; If a value is divisible by 3 and 5 the output statement is "divisible by Three and Five", If a value is divisible by 3 and 4, the output statement is "divisible by Three and Four, If a value is a number that does not fall into either category, the output statement should be "neither". Use your function to show output statements for values 16, 45, and 24.

```{r question_4}

divis <- function(numb) {
  if (numb %% 3 == 0 & numb %% 5 == 0) {
    "divisible by Three and Five"
  } else if (numb %% 3 == 0 & numb %% 4 == 0) {
    "divisible by Three and Four"
  } else {
    "neither"
  }
}

divis(16)
divis(45)
divis(24)
```

**(5)** Use piping and a dplyr command show and use R code to produce the following modified mpg data table that contains only quantitative variables

```{r question_5}
mp2 <- mpg %>% 
  select(where(is.numeric) & !year) 
mp2
```

Now use the "special loop coding chunk", illustrated in class, to produce the variance for all variables of the modified data table.

```{r}
for (i in seq_along(mp2)) {
  print(var(mp2[[i]]))
}
```

**(6)** Construct a for loop (as illustrated in the notes) that will produce the difference between the cube and the square for each prime number between 10 and 30. (There are 6 answers. The first answer is 1210, your for loop coding should produce the other five answers)

```{r question_6}

prime_ <- function(num) { #this function determines if a number is a prime, if it is prime returns TRUE
  for (i in 1 : (num %/% 4 + 1)) { #this makes the calculations 1/4 as long
    if (num %% i == 0 & i != 1) {
      return(FALSE)
    }
  }
  return(TRUE)
} 

for (i in c(10 : 30)) { #this is the main for loop that calls on the prime function above
  if (prime_(i) == TRUE) {
    print(i ^ 3 - i ^ 2)
  }
}
```

**(7)** Enter and run USArrests. What type of information is shown in the data table USArrests? (Three or four sentences).

```{r question_7, echo = FALSE}
help(USArrests)
```

USArrests consists of data from each of the 50 states from the year 1973. There are four variables including Murder, Assault, UrbanPop, and Rape. Murder, Assault and Rape show the number of related arrests for each crime per 100,000 people for each state. And UrbanPop is the percentage of the population that lives in urban areas.

**(8)** Use and show R coding that features a map function to show maximum values for all variables of the USArerests data frame. Which State has the largest number of Assaults according to the USAressts data frame ?

```{r question_eight}
map(USArrests, max)
```

```{r eight_two, include = FALSE}
#max number of Assaults is North Carolina
arrange(USArrests, desc(Assault))
```

North Carolina had the largest number of Assaults per 100,000 people at `r max(USArrests$Assault)`.

**(9)** Install the nycflights13 package: install.packages("nycflights13") , call the following library: library(nycflights13), and then enter flights (this will produce the flights data table)

```{r question_nine}
library(nycflights13)
flights
```

**(10)** Use and show R code that will indicate how many rows and how many columns the flights data has. Review and revisit your notes from STAT 412/612. Describe a tibble (two or three sentences). Now use and show R code that verifies that flights is a tibble

```{r question_ten}
glimpse(flights) #this shows that flights is 19 columns and 336,776 rows.
```

A tibble is a dataframe that is designed to work better with the tidyverse packages creating a more tidy dataframe. Tibble are all around better than standard dataframes since they show more and are easier to work with within the tidyverse.

**(11)** Now Use and show R code (featuring a map function) that will output the type of each column of the flights tibble.

```{r question_eleven}
map(flights, typeof)
```

**(12)** Use and show R coding that features usage of a map function to find the slope and the intercept of models for the different levels of the Species variable of the iris data frame. For each model, Sepal.Width predicts Sepal.Length.

```{r question_twelve}
iris %>% 
  split(.$Species) %>% 
  map(~lm(Sepal.Length ~ Sepal.Width, data = .))
```
